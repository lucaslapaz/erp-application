CREATE DATABASE IF NOT EXISTS ERP_LAPAZ;

DROP TABLE IF EXISTS USUARIOS;

CREATE TABLE USUARIOS (
    `IDUSUARIO` INT NOT NULL AUTO_INCREMENT,
    `USERNAME` VARCHAR(20) NOT NULL UNIQUE,
    `PASSWORD` VARCHAR(200) NOT NULL,
    `PERMISSION` INT NOT NULL DEFAULT 0,
    PRIMARY KEY(IDUSUARIO)
);

INSERT INTO
    USUARIOS (USERNAME, PASSWORD, PERMISSION)
VALUES
    (
        "admin",
        "$2a$06$I5spfb2xJBOJ77mmctF71ehOb8OXAys5lUIgb9MzwkFki8rtSSlni",
        10
    ),
    -- lapaz
    (
        "lucaslapaz",
        "$2a$06$EZXEMQYyiu64p33jZUIFmut.g5g9K/2VZ9ChHejtszZpHIiGsRo0S",
        5
    ),
    -- 123
    (
        "jorgebento",
        "$2a$06$gR/y7rO9HbP6a7JZ2I6SW.ZNxeWgAKd49zekd/WFfl5U2R5mbnTP6",
        0
    );

-- 321
--------------------- TESTE QUALQUER ------------------------
DROP TABLE IF EXISTS TESTES;

CREATE TABLE TESTES(
    `TEXTO` VARCHAR(200) NOT NULL,
    `ID_USUARIO` INT,
    FOREIGN KEY (ID_USUARIO) REFERENCES USUARIOS(IDUSUARIO)
);

------------------- PRODUTOS --------------------------
DROP TABLE IF EXISTS PRODUTOS;

CREATE TABLE PRODUTOS(
    `IDPRODUTO` INT NOT NULL AUTO_INCREMENT,
    `NOME` VARCHAR(100) NOT NULL,
    `VALOR` FLOAT DEFAULT 0,
    `ESTOQUE` INT DEFAULT 0,
    `UNIDADE_MEDIDA` ENUM('KG', 'UNID', 'GRAMA') NOT NULL DEFAULT 'UNID',
    PRIMARY KEY (IDPRODUTO)
);

INSERT INTO
    PRODUTOS (NOME, VALOR, ESTOQUE)
VALUES
    ('COCA-COLA 2L', 8.5, 132);

------------------- TIPOS DE FICHAS --------------------------
DROP TABLE IF EXISTS FICHAS_TIPO;

CREATE TABLE FICHAS_TIPO(
    IDTIPO INT NOT NULL AUTO_INCREMENT,
    NOMEIMAGEM VARCHAR(300) NOT NULL,
    PATHIMAGEM VARCHAR(300) NOT NULL UNIQUE,
    FORMATO VARCHAR(10) NOT NULL,
    NOMETIPOFICHA VARCHAR(40) NOT NULL UNIQUE,
    PRIMARY KEY (IDTIPO)
);

------------------- FICHAS --------------------------

DROP TABLE IF EXISTS FICHAS;

CREATE TABLE FICHAS (
    IDFICHA INT NOT NULL AUTO_INCREMENT,
    NUMERO INT NOT NULL,
    ID_TIPO INT NOT NULL,
    PRIMARY KEY (IDFICHA),
    FOREIGN KEY (ID_TIPO) REFERENCES FICHAS_TIPO(IDTIPO)
);

-------------------------------------------------------

DROP TABLE IF EXISTS PRODUTOS_FICHAS_ABERTAS;

DROP TABLE IF EXISTS VENDAS;

DROP TABLE IF EXISTS PRODUTOS_VENDAS;